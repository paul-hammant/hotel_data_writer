<!DOCTYPE html>
<html ng-app="hotelDataWriter">
<head>
    <title>Hotel Data Writer (Add/Edit Hotel)</title>
    <script type="text/javascript" ng:autobind
            src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.5/angular.min.js"></script>
    <script src='https://cdn.firebase.com/js/client/2.2.9/firebase.js'></script>
    <script src="https://cdn.firebase.com/libs/angularfire/1.1.2/angularfire.min.js"></script>

    <script type="text/javascript">
        var myApp = angular.module('hotelDataWriter', ["firebase"]);
        

        myApp.controller('MyController', ['$scope', '$firebaseObject', function($scope, $firebaseObject) {
            var ref = new Firebase('https://YOUR_FIREBASE_URL.firebaseio.com/');
            var syncObject = $firebaseObject(ref);
            var hotelKey = window.location.pathname;
            var hotelData = $firebaseObject(ref.child('hotels').child(hotelKey.replace(/_/g, ' ')));
            var hotelKeyParts = hotelKey.split("/");
            $scope.key = {};
            $scope.key.state = hotelKeyParts[1];
            $scope.key.zip = hotelKeyParts[2];
            $scope.key.city = hotelKeyParts[3].replace(/_/g, ' ');
            $scope.key.name = hotelKeyParts[4].replace(/_/g, ' ');

            hotelData.$loaded().then(function() {
                console.log("loaded record:", hotelData.$id);
            });
            $scope.data = hotelData;
            hotelData.$bindTo($scope, "hotel"); // pushes UI changes to fairebase w/o save()
        }]);

    </script>
        <link rel="stylesheet" href="/css/common.css" />
        <script src="/js/skel.min.js"></script>
        <script>
            skel.init({
                reset: 'full',
                breakpoints: {
                    large: {
                        media: '(min-width: 1025px) and (max-width: 1280px)',
                        containers: 960
                    },
                    medium: {
                        media: '(min-width: 568px) and (max-width: 1024px)',
                        containers: '90%'
                    },
                    small: {
                        media: '(max-width: 567px)',
                        containers: '95%!',
                        grid: {
                            collapse: true
                        }
                    },
                    xsmall: {
                        media: '(max-width: 320px)'
                    }
                }
            });
        </script>    
</head>
<body ng-controller="MyController">


<div id="main" class="container">

    <header id="header">
        <h1>Edit Hotel Entry</h1>
    </header>

    <div class="row">
        <label class="3u align-right">
            Name:
        </label>
        <div class="9u">
            {{key.name}}
        </div>
    </div>
    <div class="row">
        <div class="3u align-right">
            Street:
        </div>
        <div class="9u">
            <input ng-model="data.street"/>
        </div>
    </div>
    <div class="row">
        <div class="3u align-right">
            City:
        </div>
        <div class="9u">
            {{key.city}}
        </div>
    </div>
    <div class="row">
        <div class="3u align-right">
            State/Zip:
        </div>
        <div class="9u">
            {{key.state}}, {{key.zip}}
        </div>
    </div>    
    <div class="row">
        <div class="3u align-right">
            Stars:
        </div>
        <div class="9u">
            <input ng-model="data.stars"/>
        </div>
    </div>    
    <div class="row">
        <div class="3u align-right">
            Phone:
        </div>
        <div class="9u">
            <input ng-model="data.phone"/>
        </div>
    </div>  
    <div class="row">
        <div class="3u align-right">
            URL:
        </div>
        <div class="9u">
            <span style="white-space: nowrap;"><input ng-model="data.url"/> (<a ng-href="{{data.url}}" target="_blank">link</a>)</span>
        </div>
    </div>  
</div>
</body>
</html>
